{% extends 'base.html' %} <!-- Hereda de base.html -->

{% block contenido %}
<div class="row"> <!-- Fila principal: divide en dos columnas -->

    <!-- Columna principal (noticias recientes) -->
    <div class="col-md-9">
        <!-- Título con ícono -->
        <div class="d-flex align-items-center mb-4">
            <i class="fas fa-newspaper fa-2x me-2 text-primary"></i>
            <h2 class="h3 m-0">Noticias Recientes</h2>
        </div>

        <!-- ✅ Filtro por Categorías (botones) -->
        <div class="mb-4">
            <h5 class="mb-2">Filtrar por categoría:</h5>
            <div class="d-flex flex-wrap gap-2">
                <!-- Botón para ver todas -->
                <a href="{% url 'inicio' %}" 
                   class="btn btn-outline-secondary btn-sm {% if not categoria_actual %}active{% endif %}">
                    Todas
                </a>

                <!-- Botones por cada categoría -->
                {% for categoria in categorias %}
                    <a href="{% url 'inicio' %}?categoria={{ categoria.id }}"
                       class="btn btn-outline-primary btn-sm {% if categoria_actual == categoria.id %}active{% endif %}">
                        {{ categoria.nombre }}
                    </a>
                {% endfor %}
            </div>
        </div>

        <!-- Bucle que recorre todas las noticias en una sola columna -->
        {% for noticia in noticias %}
        <div class="mb-4 border-bottom pb-3">
            <!-- Título con enlace a la página de detalle -->
            <h2>
                <a href="{% url 'detalle_noticia' noticia.pk %}" class="text-decoration-none text-dark">
                    {{ noticia.titulo }}
                </a>
            </h2>

            <!-- Si la noticia tiene imagen, mostrarla completa sin corte -->
            {% if noticia.imagen %}
            <img src="{{ noticia.imagen.url }}" 
                 class="img-fluid rounded mb-3 w-100" 
                 style="height: auto; object-fit: contain;" 
                 alt="Imagen de la noticia">
            {% endif %}

            <!-- Mostrar el resumen o bajada -->
            <p>{{ noticia.resumen }}</p>
        </div>
        {% empty %}
        <!-- Si no hay noticias -->
        <p>No hay noticias aún.</p>
        {% endfor %}
    </div>

    <!-- Columna lateral derecha (noticias destacadas) -->
    <div class="col-md-3">
        <!-- Caja destacada con fondo claro -->
        <div class="p-3 bg-light rounded shadow-sm" style="font-size: 0.9rem;">
            <!-- Encabezado con ícono -->
            <div class="d-flex align-items-center justify-content-center mb-3">
                <i class="fas fa-star text-warning me-2"></i>
                <h4 class="m-0">Noticias Destacadas</h4>
            </div>

            <!-- Mostrar 3 primeras noticias destacadas como mini tarjetas -->
            {% for noticia in noticias_destacadas %}
            <div class="mb-3 border-bottom pb-2">
                <h6 class="text-primary">{{ noticia.titulo }}</h6>
                <small class="text-muted">
                    {{ noticia.fecha_publicacion|date:"d M Y" }}
                </small><br>
                <a href="{% url 'detalle_noticia' noticia.pk %}" class="link-secondary">Leer más →</a>
            </div>
            {% endfor %}
        </div>
    </div>

</div> <!-- Fin de la fila -->
{% endblock %}
